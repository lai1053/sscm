(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-953c"],{"/h46":function(e,t,n){n("cHUd")("Map")},MZEQ:function(e,t,n){},NYYv:function(e,t,n){"use strict";var a=n("MZEQ");n.n(a).a},ODRq:function(e,t,n){e.exports={default:n("UDep"),__esModule:!0}},UDep:function(e,t,n){n("wgeU"),n("FlQf"),n("bBy9"),n("g33z"),n("XLbu"),n("/h46"),n("dVTT"),e.exports=n("WEpk").Map},XLbu:function(e,t,n){var a=n("Y7ZC");a(a.P+a.R,"Map",{toJSON:n("8iia")("Map")})},dVTT:function(e,t,n){n("aPfg")("Map")},g33z:function(e,t,n){"use strict";var a=n("Wu5q"),r=n("n3ko");e.exports=n("raTm")("Map",function(e){return function(){return e(this,arguments.length>0?arguments[0]:void 0)}},{get:function(e){var t=a.getEntry(r(this,"Map"),e);return t&&t.v},set:function(e,t){return a.def(r(this,"Map"),0===e?0:e,t)}},a,!0)},vZzs:function(e,t,n){"use strict";n.r(t);var a=n("P2sY"),r=n.n(a),i=n("sk9p"),s=n.n(i),o=n("ODRq"),l=n.n(o),d=n("QbLZ"),c=n.n(d),u=n("jWXv"),p=n.n(u),f=n("rfXi"),h=n.n(f),v=n("14Xm"),m=n.n(v),w=n("D3Ub"),g=n.n(w),y=n("MT78"),C=n.n(y),b=n("v7LQ"),_=n("kzTS"),L={name:"OceanengineCustomersList",data:function(){return{productLineOptions:_.a,filters:{windowType:"30",customWindow:30,productLine:"ALL",saleUserId:null,keyword:"",riskLevel:"ALL"},companies:[],advertisers:[],companyLoading:!1,advertiserLoading:!1,allowedSaleUserIds:[],saleOptions:[],lastSaleOptionProductLine:null,selectedAdvCompanyId:null,pagination:{companies:{currentPage:1,pageSize:10},advertisers:{currentPage:1,pageSize:10}},trendDialog:{visible:!1,loading:!1,data:[],windowType:"30",customWindow:30,advCompanyId:null,companyName:""},trendChart:null}},computed:{isAdminUser:function(){var e=this.$store.getters.userInfo||{};return!!(e.isAdmin||e.is_admin||e.admin||e.superAdmin||e.isSuperAdmin||"admin"===e.username)},effectiveWindow:function(){var e="custom"===this.filters.windowType?Number(this.filters.customWindow||0):Number(this.filters.windowType||30);return e>0?e:30},windowLabel:function(){return"近"+this.effectiveWindow+"天"},productLineLabel:function(){return Object(_.f)(this.filters.productLine)},adsLabel:function(){return Object(_.c)(this.filters.productLine)},filteredCompanies:function(){return this.applyRiskFilter(this.applyKeywordFilter(this.companies,"company"))},pagedCompanies:function(){return this.getPagedData(this.filteredCompanies,this.pagination.companies)},filteredAdvertisers:function(){return this.applyRiskFilter(this.applyKeywordFilter(this.advertisers,"advertiser"))},pagedAdvertisers:function(){return this.getPagedData(this.filteredAdvertisers,this.pagination.advertisers)},selectedCompanyLabel:function(){var e=this,t=(this.companies||[]).find(function(t){return t.advCompanyId===e.selectedAdvCompanyId});return t&&t.advCompanyName||""},saleLabel:function(){var e=this,t=this.saleOptions.find(function(t){return t.value===e.filters.saleUserId});return t?t.label:""},currentUserId:function(){var e=this.$store.getters.userInfo;return e&&(e.userId||e.user_id||e.id)}},created:function(){var e=this;return g()(m.a.mark(function t(){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.initFromQuery(),t.next=3,e.loadAllowedSaleUsers();case 3:return e.normalizeSaleUser(),t.next=6,e.loadSaleOptions();case 6:e.handleFilterChange();case 7:case"end":return t.stop()}},t,e)}))()},mounted:function(){window.addEventListener("resize",this.handleResize)},beforeDestroy:function(){this.teardownChart(),window.removeEventListener("resize",this.handleResize)},methods:{initFromQuery:function(){var e=this.$route.query||{};if(e.window){var t=Number(e.window);7===t||15===t||30===t?this.filters.windowType=String(t):!isNaN(t)&&t>0&&(this.filters.windowType="custom",this.filters.customWindow=t)}e.productLine&&(this.filters.productLine=String(e.productLine).toUpperCase()),e.saleUserId&&(this.filters.saleUserId=Number(e.saleUserId)),e.keyword&&(this.filters.keyword=String(e.keyword)),e.riskLevel&&(this.filters.riskLevel=String(e.riskLevel).toUpperCase())},loadAllowedSaleUsers:function(){var e=this;return g()(m.a.mark(function t(){var n,a;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.isAdminUser){t.next=3;break}return e.allowedSaleUserIds=null,t.abrupt("return");case 3:if(e.currentUserId){t.next=6;break}return e.allowedSaleUserIds=[],t.abrupt("return");case 6:return n=[Number(e.currentUserId)],t.prev=7,t.next=10,Object(b.b)(e.currentUserId);case 10:a=t.sent,(a.data||[]).forEach(function(e){return n.push(Number(e))}),t.next=17;break;case 15:t.prev=15,t.t0=t.catch(7);case 17:e.allowedSaleUserIds=h()(new p.a(n.filter(Boolean)));case 18:case"end":return t.stop()}},t,e,[[7,15]])}))()},normalizeSaleUser:function(){var e=this,t=this.allowedSaleUserIds,n=this.saleOptions||[];t&&0!==t.length?this.filters.saleUserId&&t.includes(this.filters.saleUserId)||(this.filters.saleUserId=t[0]):!n.length||this.filters.saleUserId&&n.some(function(t){return t.value===e.filters.saleUserId})?!n.length&&this.currentUserId&&(this.filters.saleUserId=this.currentUserId):this.filters.saleUserId=n[0].value},loadSaleOptions:function(){var e=this;return g()(m.a.mark(function t(){var n,a,r,i;return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.lastSaleOptionProductLine!==e.filters.productLine||!e.saleOptions.length){t.next=3;break}return e.normalizeSaleUser(),t.abrupt("return");case 3:return t.prev=3,t.next=6,Object(b.h)(c()({window:e.effectiveWindow},Object(_.e)(e.filters.productLine)));case 6:n=t.sent,a=n.data||{},r=Array.isArray(a)?a:a.list||a.records||[],i=new l.a,r.forEach(function(t){e.allowedSaleUserIds&&!e.allowedSaleUserIds.includes(t.saleUserId)||i.set(t.saleUserId,t.saleName||t.crmRealname||"ID "+t.saleUserId)}),e.allowedSaleUserIds&&e.allowedSaleUserIds.forEach(function(e){i.has(e)||i.set(e,"ID "+e)}),e.saleOptions=h()(i.entries()).map(function(e){var t=s()(e,2);return{value:t[0],label:t[1]}}),t.next=18;break;case 15:t.prev=15,t.t0=t.catch(3),e.allowedSaleUserIds?e.saleOptions=e.allowedSaleUserIds.map(function(e){return{value:e,label:"ID "+e}}):e.saleOptions=[];case 18:e.lastSaleOptionProductLine=e.filters.productLine,e.normalizeSaleUser();case 20:case"end":return t.stop()}},t,e,[[3,15]])}))()},handleCustomWindowChange:function(){(!this.filters.customWindow||this.filters.customWindow<1)&&(this.filters.customWindow=30),this.handleFilterChange()},handleRiskChange:function(){var e=this;this.pagination.companies.currentPage=1,this.pagination.advertisers.currentPage=1;var t=this.filteredCompanies,n=t.find(function(t){return t.advCompanyId===e.selectedAdvCompanyId});this.selectedAdvCompanyId=n?n.advCompanyId:t[0]&&t[0].advCompanyId||null,this.loadAdvertisers(),this.syncQuery()},handleFilterChange:function(){var e=this;return g()(m.a.mark(function t(){return m.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.pagination.companies.currentPage=1,e.pagination.advertisers.currentPage=1,e.selectedAdvCompanyId=null,e.advertisers=[],t.next=6,e.loadSaleOptions();case 6:e.normalizeSaleUser(),e.loadCompanies(),e.trendDialog.visible&&e.trendDialog.advCompanyId&&e.loadTrend(),e.syncQuery();case 10:case"end":return t.stop()}},t,e)}))()},buildFilterParams:function(e){var t=Object(_.e)(this.filters.productLine),n=r()({window:e||this.effectiveWindow},t);return this.filters.saleUserId&&(n.saleUserId=this.filters.saleUserId),this.filters.keyword&&(n.keyword=this.filters.keyword),n},buildCompanyParams:function(){return this.buildFilterParams()},buildAdvertiserParams:function(){var e=this.buildCompanyParams();return this.selectedAdvCompanyId&&(e.advCompanyId=this.selectedAdvCompanyId),e},loadCompanies:function(){var e=this;if(this.companies=[],this.advertisers=[],this.filters.saleUserId){var t=this.buildCompanyParams();this.companyLoading=!0,Object(b.c)(t).then(function(t){var n=t.data||{},a=((Array.isArray(n)?n:n.list||n.records||[])||[]).map(function(e,t){var n=e&&e.advCompanyId?String(e.advCompanyId):"unknown",a=[n,e&&(e.channelCode||e.channel)?String(e.channelCode||e.channel):"",e&&e.accountSource?String(e.accountSource):""].filter(Boolean).join("-")||n;return c()({},e,{_rowKey:a+"-"+t})});e.companies=a;var r=e.applyRiskFilter(a),i=r.find(function(t){return t.advCompanyId===e.selectedAdvCompanyId});e.selectedAdvCompanyId=i?i.advCompanyId:r[0]&&r[0].advCompanyId||null,e.pagination.companies.currentPage=1,e.pagination.advertisers.currentPage=1,e.loadAdvertisers()}).catch(function(){e.companies=[],e.selectedAdvCompanyId=null,e.advertisers=[]}).finally(function(){e.companyLoading=!1})}else this.companyLoading=!1},loadAdvertisers:function(){var e=this;if(this.advertisers=[],this.selectedAdvCompanyId){var t=this.buildAdvertiserParams();this.advertiserLoading=!0,Object(b.a)(t).then(function(t){var n=t.data||{},a=Array.isArray(n)?n:n.list||n.records||[];e.advertisers=(a||[]).map(function(e,t){var n=e&&e.advertiserId?String(e.advertiserId):"unknown",a=[n,e&&(e.channelCode||e.channel)?String(e.channelCode||e.channel):"",e&&e.accountSource?String(e.accountSource):""].filter(Boolean).join("-")||n;return c()({},e,{_rowKey:a+"-"+t})}),e.pagination.advertisers.currentPage=1}).catch(function(){e.advertisers=[]}).finally(function(){e.advertiserLoading=!1})}else this.advertiserLoading=!1},handleCompanyRowClick:function(e){e&&e.advCompanyId&&e.advCompanyId!==this.selectedAdvCompanyId&&(this.selectedAdvCompanyId=e.advCompanyId,this.pagination.advertisers.currentPage=1,this.loadAdvertisers())},companyRowClass:function(e){return e.row.advCompanyId===this.selectedAdvCompanyId?"is-selected-row":""},applyRiskFilter:function(e){var t=(this.filters.riskLevel||"ALL").toUpperCase();return"ALL"===t?e||[]:(e||[]).filter(function(e){return(e.riskLevel||"").toUpperCase()===t})},applyKeywordFilter:function(e,t){var n=String(this.filters.keyword||"").trim();if(!n)return e||[];var a=n.toLowerCase(),r=e||[];return"advertiser"===t?r.filter(function(e){var t=(e.advertiserName||"").toLowerCase(),n=(e.advCompanyName||"").toLowerCase();return t.includes(a)||n.includes(a)}):r.filter(function(e){var t=(e.advCompanyName||"").toLowerCase(),n=(e.ownerName||"").toLowerCase();return t.includes(a)||n.includes(a)})},getPagedData:function(e,t){var n=t&&t.currentPage||1,a=t&&t.pageSize||10,r=(n-1)*a;return(e||[]).slice(r,r+a)},companyIndex:function(e){return(this.pagination.companies.currentPage-1)*this.pagination.companies.pageSize+e+1},advertiserIndex:function(e){return(this.pagination.advertisers.currentPage-1)*this.pagination.advertisers.pageSize+e+1},showAdsColumn:function(e){return Object(_.h)(e)},showQcColumn:function(e){return Object(_.i)(e)},adsDisplayCost:function(e,t){return Object(_.b)(e,t||this.filters.productLine)},qcDisplayCost:function(e){return Object(_.g)(e)},formatTotalByProductLine:function(e){return Object(_.j)(e,this.filters.productLine)},displayProductLine:function(e,t){return Object(_.d)(e,t)},formatAccountSource:function(e){return{ALL:"全部来源",AD:"AD",LOCAL:"LOCAL",STAR:"STAR",LUBAN:"鲁班",DOMESTIC:"DOMESTIC",QIANCHUAN:"千川"}[e]||e||"-"},formatAmount:function(e){if(null==e||""===e)return"-";var t=Number(e);return isNaN(t)?e:t.toLocaleString("zh-CN",{minimumFractionDigits:2,maximumFractionDigits:2})},formatDate:function(e){if(!e)return"-";var t=new Date(e);return isNaN(t.getTime())?"-":t.getFullYear()+"-"+(""+(t.getMonth()+1)).padStart(2,"0")+"-"+(""+t.getDate()).padStart(2,"0")},formatInactive:function(e){if(null==e)return"-";var t=Number(e);return isNaN(t)?"-":t+" 天未消耗"},riskLabel:function(e){var t=(e||"").toUpperCase();return"ACTIVE"===t?"活跃":"WARN"===t?"预警":"危险"},riskTagType:function(e){var t=(e||"").toUpperCase();return"ACTIVE"===t?"success":"WARN"===t?"warning":"danger"},openTrend:function(e){var t=this;e&&e.advCompanyId&&(this.trendDialog.advCompanyId=e.advCompanyId,this.trendDialog.companyName=e.advCompanyName||"客户趋势",this.trendDialog.windowType=this.filters.windowType,this.trendDialog.customWindow=this.filters.customWindow,this.trendDialog.visible=!0,this.$nextTick(function(){t.loadTrend()}))},trendWindowValue:function(){var e="custom"===this.trendDialog.windowType?Number(this.trendDialog.customWindow||0):Number(this.trendDialog.windowType||30);return e>0?e:30},handleTrendWindowChange:function(){"custom"===this.trendDialog.windowType&&(!this.trendDialog.customWindow||this.trendDialog.customWindow<1)&&(this.trendDialog.customWindow=30),this.trendDialog.visible&&this.loadTrend()},loadTrend:function(){var e=this;if(this.trendDialog.advCompanyId){this.trendDialog.loading=!0;var t=Object(_.e)(this.filters.productLine);Object(b.d)(this.trendDialog.advCompanyId,{window:this.trendWindowValue(),channel:t.channel,accountSource:t.accountSource}).then(function(t){e.trendDialog.data=t.data||[],e.$nextTick(function(){e.renderTrendChart()})}).catch(function(){e.trendDialog.data=[],e.renderTrendChart()}).finally(function(){e.trendDialog.loading=!1})}},renderTrendChart:function(){var e=this;if(this.ensureTrendChart(),this.trendChart){var t=this.trendDialog.data||[],n=t.map(function(t){return e.formatDate(t.statDate)}),a=t.map(function(t){return Object(_.b)(t,e.filters.productLine)}),r=t.map(function(e){return Object(_.g)(e)}),i=["总消耗"],s=[{name:"总消耗",type:"line",smooth:!0,data:t.map(function(t){return Object(_.j)(t,e.filters.productLine)}),showSymbol:!1}];this.showAdsColumn(this.filters.productLine)&&(i.push(this.adsLabel),s.push({name:this.adsLabel,type:"line",smooth:!0,data:a,showSymbol:!1})),this.showQcColumn(this.filters.productLine)&&(i.push("千川"),s.push({name:"千川",type:"line",smooth:!0,data:r,showSymbol:!1}));var o={tooltip:{trigger:"axis"},legend:{data:i},grid:{top:30,left:50,right:20,bottom:50},xAxis:{type:"category",boundaryGap:!1,data:n},yAxis:{type:"value",name:"消耗(元)"},series:s};this.trendChart.setOption(o,!0),this.trendChart.resize()}},ensureTrendChart:function(){!this.trendChart&&this.$refs.trendChart&&(this.trendChart=C.a.init(this.$refs.trendChart))},handleTrendClose:function(){this.trendDialog.visible=!1,this.trendDialog.data=[],this.trendDialog.advCompanyId=null,this.teardownChart()},handleCompanyPageChange:function(e){this.pagination.companies.currentPage=e},handleAdvertiserPageChange:function(e){this.pagination.advertisers.currentPage=e},teardownChart:function(){this.trendChart&&(this.trendChart.dispose(),this.trendChart=null)},handleResize:function(){this.trendChart&&this.trendChart.resize()},syncQuery:function(){var e={window:this.effectiveWindow,productLine:this.filters.productLine};this.filters.saleUserId&&(e.saleUserId=this.filters.saleUserId),this.filters.keyword&&(e.keyword=this.filters.keyword),this.filters.riskLevel&&"ALL"!==this.filters.riskLevel&&(e.riskLevel=this.filters.riskLevel),this.$router.replace({path:"/oceanengine/customers",query:e})}}},k=(n("NYYv"),n("KHd+")),I=Object(k.a)(L,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"oe-customers"},[n("el-card",{staticClass:"filter-card",attrs:{shadow:"never"}},[n("div",{staticClass:"filter-bar"},[n("div",{staticClass:"filter-left"},[n("el-select",{staticClass:"filter-item",attrs:{size:"small"},on:{change:e.handleFilterChange},model:{value:e.filters.windowType,callback:function(t){e.$set(e.filters,"windowType",t)},expression:"filters.windowType"}},[n("el-option",{attrs:{label:"近7天",value:"7"}}),e._v(" "),n("el-option",{attrs:{label:"近15天",value:"15"}}),e._v(" "),n("el-option",{attrs:{label:"近30天",value:"30"}}),e._v(" "),n("el-option",{attrs:{label:"自定义",value:"custom"}})],1),e._v(" "),"custom"===e.filters.windowType?n("el-input-number",{staticClass:"filter-item narrow",attrs:{min:1,max:120,step:1,size:"small"},on:{change:e.handleCustomWindowChange},model:{value:e.filters.customWindow,callback:function(t){e.$set(e.filters,"customWindow",t)},expression:"filters.customWindow"}}):e._e(),e._v(" "),n("el-select",{staticClass:"filter-item",attrs:{placeholder:"产品线",size:"small"},on:{change:e.handleFilterChange},model:{value:e.filters.productLine,callback:function(t){e.$set(e.filters,"productLine",t)},expression:"filters.productLine"}},e._l(e.productLineOptions,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),n("el-select",{staticClass:"filter-item",attrs:{placeholder:"销售筛选",size:"small"},on:{change:e.handleFilterChange},model:{value:e.filters.saleUserId,callback:function(t){e.$set(e.filters,"saleUserId",t)},expression:"filters.saleUserId"}},e._l(e.saleOptions,function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),e._v(" "),n("el-input",{staticClass:"filter-item",attrs:{placeholder:"公司/广告主关键词",clearable:"",size:"small"},on:{clear:e.handleFilterChange},nativeOn:{keyup:function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.handleFilterChange(t):null}},model:{value:e.filters.keyword,callback:function(t){e.$set(e.filters,"keyword",t)},expression:"filters.keyword"}}),e._v(" "),n("el-select",{staticClass:"filter-item",attrs:{placeholder:"风险筛选",size:"small"},on:{change:e.handleRiskChange},model:{value:e.filters.riskLevel,callback:function(t){e.$set(e.filters,"riskLevel",t)},expression:"filters.riskLevel"}},[n("el-option",{attrs:{label:"全部风险",value:"ALL"}}),e._v(" "),n("el-option",{attrs:{label:"活跃",value:"ACTIVE"}}),e._v(" "),n("el-option",{attrs:{label:"预警",value:"WARN"}}),e._v(" "),n("el-option",{attrs:{label:"危险",value:"DANGER"}})],1),e._v(" "),n("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-refresh"},on:{click:e.handleFilterChange}},[e._v("刷新")])],1),e._v(" "),n("div",{staticClass:"filter-tip"},[e._v("\n        "+e._s(e.windowLabel)+" · "+e._s(e.productLineLabel)),e.saleLabel?n("span",[e._v(" · 销售："+e._s(e.saleLabel))]):e._e()])])]),e._v(" "),n("el-card",{staticClass:"list-card",attrs:{shadow:"never"}},[n("div",{staticClass:"card-header",attrs:{slot:"header"},slot:"header"},[n("div",[e._v("客户列表")]),e._v(" "),n("div",{staticClass:"actions"},[n("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-refresh"},on:{click:e.handleFilterChange}},[e._v("刷新")])],1)]),e._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.companyLoading,expression:"companyLoading"}],attrs:{data:e.pagedCompanies,"row-key":"_rowKey","row-class-name":e.companyRowClass,border:"",size:"mini","highlight-current-row":""},on:{"row-click":e.handleCompanyRowClick}},[n("el-table-column",{attrs:{type:"index",label:"序号",width:"60",index:e.companyIndex}}),e._v(" "),n("el-table-column",{attrs:{prop:"advCompanyName",label:"公司","min-width":"160"}}),e._v(" "),n("el-table-column",{attrs:{prop:"ownerName",label:"客户归属","min-width":"110"}}),e._v(" "),n("el-table-column",{attrs:{label:"产品线",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.displayProductLine(t.row.channelCode||t.row.channel,t.row.accountSource)))]}}])}),e._v(" "),e.showAdsColumn(e.filters.productLine)?n("el-table-column",{attrs:{label:e.adsLabel,width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.formatAmount(e.adsDisplayCost(t.row,e.filters.productLine))))]}}])}):e._e(),e._v(" "),n("el-table-column",{attrs:{label:"本地推",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.formatAmount(t.row.localCost)))]}}])}),e._v(" "),e.showQcColumn(e.filters.productLine)?n("el-table-column",{attrs:{label:"千川消耗",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.formatAmount(e.qcDisplayCost(t.row))))]}}])}):e._e(),e._v(" "),n("el-table-column",{attrs:{label:"总消耗",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.formatAmount(e.formatTotalByProductLine(t.row))))]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"最近消耗",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.formatDate(t.row.lastCostDate)))]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"不活跃天数",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.formatInactive(t.row.inactiveDays)))]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"风险",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-tag",{attrs:{type:e.riskTagType(t.row.riskLevel),size:"mini"}},[e._v("\n            "+e._s(e.riskLabel(t.row.riskLevel))+"\n          ")])]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"趋势",width:"80"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(n){n.stopPropagation(),e.openTrend(t.row)}}},[e._v("查看")])]}}])})],1),e._v(" "),n("div",{staticClass:"table-footer"},[n("el-pagination",{attrs:{layout:"prev, pager, next","current-page":e.pagination.companies.currentPage,"page-size":e.pagination.companies.pageSize,total:e.filteredCompanies.length},on:{"update:currentPage":function(t){e.$set(e.pagination.companies,"currentPage",t)},"current-change":e.handleCompanyPageChange}})],1)],1),e._v(" "),n("el-card",{staticClass:"list-card",attrs:{shadow:"never"}},[n("div",{staticClass:"card-header",attrs:{slot:"header"},slot:"header"},[n("div",[e._v("\n        广告主明细\n        "),e.selectedCompanyLabel?n("span",{staticClass:"header-ctx"},[e._v("（公司："+e._s(e.selectedCompanyLabel)+"）")]):e._e()]),e._v(" "),n("div",{staticClass:"actions"},[n("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-refresh"},on:{click:e.loadAdvertisers}},[e._v("刷新")])],1)]),e._v(" "),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.advertiserLoading,expression:"advertiserLoading"}],attrs:{data:e.pagedAdvertisers,"row-key":"_rowKey",border:"",size:"mini"}},[n("el-table-column",{attrs:{type:"index",label:"序号",width:"60",index:e.advertiserIndex}}),e._v(" "),n("el-table-column",{attrs:{prop:"advertiserName",label:"广告主","min-width":"160"}}),e._v(" "),n("el-table-column",{attrs:{label:"产品线",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.displayProductLine(t.row.channelCode||t.row.channel,t.row.accountSource)))]}}])}),e._v(" "),e.showAdsColumn(e.filters.productLine)?n("el-table-column",{attrs:{label:e.adsLabel,width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.formatAmount(e.adsDisplayCost(t.row,e.filters.productLine))))]}}])}):e._e(),e._v(" "),n("el-table-column",{attrs:{label:"本地推",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.formatAmount(t.row.localCost)))]}}])}),e._v(" "),e.showQcColumn(e.filters.productLine)?n("el-table-column",{attrs:{label:"千川消耗",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.formatAmount(e.qcDisplayCost(t.row))))]}}])}):e._e(),e._v(" "),n("el-table-column",{attrs:{label:"总消耗",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.formatAmount(e.formatTotalByProductLine(t.row))))]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"最近消耗",width:"110"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.formatDate(t.row.lastCostDate)))]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"不活跃天数",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e.formatInactive(t.row.inactiveDays)))]}}])}),e._v(" "),n("el-table-column",{attrs:{label:"风险",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-tag",{attrs:{type:e.riskTagType(t.row.riskLevel),size:"mini"}},[e._v("\n            "+e._s(e.riskLabel(t.row.riskLevel))+"\n          ")])]}}])})],1),e._v(" "),n("div",{staticClass:"table-footer"},[n("el-pagination",{attrs:{layout:"prev, pager, next","current-page":e.pagination.advertisers.currentPage,"page-size":e.pagination.advertisers.pageSize,total:e.filteredAdvertisers.length},on:{"update:currentPage":function(t){e.$set(e.pagination.advertisers,"currentPage",t)},"current-change":e.handleAdvertiserPageChange}})],1)],1),e._v(" "),n("el-dialog",{attrs:{visible:e.trendDialog.visible,"close-on-click-modal":!1,width:"900px"},on:{"update:visible":function(t){e.$set(e.trendDialog,"visible",t)},close:e.handleTrendClose}},[n("div",{staticClass:"trend-title",attrs:{slot:"title"},slot:"title"},[e._v("\n      "+e._s(e.trendDialog.companyName||"客户趋势")+"\n      "),n("span",{staticClass:"header-ctx"},[e._v("（"+e._s(e.productLineLabel)+"）")])]),e._v(" "),n("div",{staticClass:"trend-toolbar"},[n("el-radio-group",{attrs:{size:"mini"},on:{change:e.handleTrendWindowChange},model:{value:e.trendDialog.windowType,callback:function(t){e.$set(e.trendDialog,"windowType",t)},expression:"trendDialog.windowType"}},[n("el-radio-button",{attrs:{label:"7"}},[e._v("近7天")]),e._v(" "),n("el-radio-button",{attrs:{label:"15"}},[e._v("近15天")]),e._v(" "),n("el-radio-button",{attrs:{label:"30"}},[e._v("近30天")]),e._v(" "),n("el-radio-button",{attrs:{label:"custom"}},[e._v("自定义")])],1),e._v(" "),"custom"===e.trendDialog.windowType?n("el-input-number",{staticClass:"filter-item narrow",attrs:{min:1,max:180,size:"small"},on:{change:e.handleTrendWindowChange},model:{value:e.trendDialog.customWindow,callback:function(t){e.$set(e.trendDialog,"customWindow",t)},expression:"trendDialog.customWindow"}}):e._e(),e._v(" "),n("el-button",{attrs:{size:"mini",type:"primary",icon:"el-icon-refresh"},on:{click:e.loadTrend}},[e._v("刷新趋势")])],1),e._v(" "),n("div",{directives:[{name:"loading",rawName:"v-loading",value:e.trendDialog.loading,expression:"trendDialog.loading"}],ref:"trendChart",staticClass:"trend-chart"}),e._v(" "),e.trendDialog.loading||e.trendDialog.data&&0!==e.trendDialog.data.length?e._e():n("el-empty",{staticClass:"trend-empty",attrs:{"image-size":80,description:"该时间段内无消耗"}})],1)],1)},[],!1,null,"f20a5788",null);I.options.__file="CustomersList.vue";t.default=I.exports}}]);